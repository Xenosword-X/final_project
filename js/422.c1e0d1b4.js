"use strict";(self["webpackChunkfinal_project"]=self["webpackChunkfinal_project"]||[]).push([[422],{1422:function(t,e,s){s.r(e),s.d(e,{default:function(){return Z}});var a=s(6768),o=s(5130),l=s(4232);const i={class:"container"},r={class:"row mt-4"},n={class:"col-md-8"},c={class:"row row-cols-1 row-cols-md-3 g-4"},d={class:"card h-100"},u={class:"card-body"},p={class:"card-title"},h={class:"card-text"},m={key:0},g={key:1},k={class:"text-muted"},b={class:"text-danger"},L={class:"d-flex justify-content-between"},v=["onClick"],f=["onClick","disabled"],C={key:0,class:"spinner-grow text-danger spinner-grow-sm",role:"status"},y={class:"mt-4"},x={class:"pagination justify-content-center"},w=["onClick"],_={class:"col-md-4"},P={class:"sticky-top"},$={class:"table align-middle"},I=["disabled","onClick"],E={key:0,class:"text-success"},F={class:"input-group input-group-sm"},V=["onChange","onUpdate:modelValue","disabled"],X={class:"input-group-text"},U={class:"text-end"},q={key:0,class:"text-success"},T={key:0,class:"text-start"},Q=["colspan"],j={class:"text-end"},A={key:0},K={class:"text-end text-success"},D={class:"input-group mb-3 input-group-sm"},J={class:"input-group-append"},S={class:"my-5 row justify-content-center"},W={class:"mb-3"},M={class:"mb-3"},O={class:"mb-3"},z={class:"mb-3"},B={class:"mb-3"};function G(t,e,s,G,H,N){const R=(0,a.g2)("Loading"),Y=(0,a.g2)("Field"),Z=(0,a.g2)("ErrorMessage"),tt=(0,a.g2)("Form");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(R,{active:t.isLoading},null,8,["active"]),(0,a.Lk)("div",i,[(0,a.Lk)("div",r,[(0,a.Lk)("div",n,[(0,a.bo)((0,a.Lk)("select",{class:"form-select mb-3","aria-label":"product-category","onUpdate:modelValue":e[0]||(e[0]=t=>H.selectedCategory=t)},e[11]||(e[11]=[(0,a.Fv)('<option value="" disabled>請選擇類別</option><option value="">全部</option><option value="主機">主機</option><option value="遊戲">遊戲</option><option value="配件">配件</option>',5)]),512),[[o.u1,H.selectedCategory]]),(0,a.Lk)("div",c,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(N.paginatedProducts,s=>((0,a.uX)(),(0,a.CE)("div",{class:"col",key:s.id},[(0,a.Lk)("div",d,[(0,a.Lk)("div",{class:"card-img-top",style:(0,l.Tr)({height:"400px",backgroundImage:`url(${s.imageUrl})`,backgroundSize:"cover",backgroundPosition:"center"})},null,4),(0,a.Lk)("div",u,[(0,a.Lk)("h5",p,(0,l.v_)(s.title),1),(0,a.Lk)("p",h,[s.price?((0,a.uX)(),(0,a.CE)("span",g,[(0,a.Lk)("del",k,"原價 "+(0,l.v_)(t.$filters.currency(s.origin_price))+" 元",1),e[12]||(e[12]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("strong",b,"特價 "+(0,l.v_)(t.$filters.currency(s.price))+" 元",1)])):((0,a.uX)(),(0,a.CE)("span",m,(0,l.v_)(s.origin_price)+" 元",1))]),(0,a.Lk)("div",L,[(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t=>N.getProduct(s.id)}," 查看更多 ",8,v),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-danger",onClick:t=>N.addCart(s.id),disabled:this.status.loadingItem===s.id},[this.status.loadingItem===s.id?((0,a.uX)(),(0,a.CE)("div",C,e[13]||(e[13]=[(0,a.Lk)("span",{class:"visually-hidden"},"Loading...",-1)]))):(0,a.Q3)("",!0),e[14]||(e[14]=(0,a.eW)(" 加到購物車 "))],8,f)])])])]))),128))]),(0,a.Lk)("nav",y,[(0,a.Lk)("ul",x,[(0,a.Lk)("li",{class:(0,l.C4)(["page-item",{disabled:1===H.currentPage}])},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:e[1]||(e[1]=(0,o.D$)(t=>H.currentPage--,["prevent"]))},"上一頁")],2),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(N.totalPages,t=>((0,a.uX)(),(0,a.CE)("li",{class:(0,l.C4)(["page-item",{active:H.currentPage===t}]),key:t},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:(0,o.D$)(e=>H.currentPage=t,["prevent"])},(0,l.v_)(t),9,w)],2))),128)),(0,a.Lk)("li",{class:(0,l.C4)(["page-item",{disabled:H.currentPage===N.totalPages}])},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:e[2]||(e[2]=(0,o.D$)(t=>H.currentPage++,["prevent"]))},"下一頁")],2)])])]),(0,a.Lk)("div",_,[(0,a.Lk)("div",P,[(0,a.Lk)("table",$,[e[17]||(e[17]=(0,a.Lk)("thead",null,[(0,a.Lk)("tr",null,[(0,a.Lk)("th"),(0,a.Lk)("th",null,"品名"),(0,a.Lk)("th",{style:{width:"110px"}},"數量"),(0,a.Lk)("th",null,"單價")])],-1)),(0,a.Lk)("tbody",null,[H.cart.carts?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(H.cart.carts,s=>((0,a.uX)(),(0,a.CE)("tr",{key:s.id},[(0,a.Lk)("td",null,[(0,a.Lk)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:H.status.loadingItem===s.id,onClick:t=>N.delCartItem(s.id)},e[15]||(e[15]=[(0,a.Lk)("i",{class:"bi bi-x"},null,-1)]),8,I)]),(0,a.Lk)("td",null,[(0,a.eW)((0,l.v_)(s.product.title)+" ",1),s.coupon?((0,a.uX)(),(0,a.CE)("div",E," 已套用優惠券 ")):(0,a.Q3)("",!0)]),(0,a.Lk)("td",null,[(0,a.Lk)("div",F,[(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",min:"1",onChange:t=>N.updateCart(s),"onUpdate:modelValue":t=>s.qty=t,disabled:s.id===H.status.loadingItem},null,40,V),[[o.Jo,s.qty,void 0,{number:!0}]]),(0,a.Lk)("div",X,"/ "+(0,l.v_)(s.product.unit),1)])]),(0,a.Lk)("td",U,[H.cart.final_total!==H.cart.total?((0,a.uX)(),(0,a.CE)("small",q,"折扣價：")):(0,a.Q3)("",!0),(0,a.eW)(" "+(0,l.v_)(t.$filters.currency(s.final_total)),1)])]))),128)):(0,a.Q3)("",!0)]),(0,a.Lk)("tfoot",null,[(0,a.Lk)("tr",null,[H.cart.carts&&H.cart.carts.length?((0,a.uX)(),(0,a.CE)("td",T,[(0,a.Lk)("button",{class:"btn btn-outline-danger text-nowrap",type:"button",onClick:e[3]||(e[3]=t=>N.delAllCart())},"清空購物車")])):(0,a.Q3)("",!0),(0,a.Lk)("td",{colspan:H.cart.carts&&H.cart.carts.length?2:3,class:"text-end"},"總計",8,Q),(0,a.Lk)("td",j,(0,l.v_)(t.$filters.currency(H.cart.total)),1)]),H.cart.final_total!==H.cart.total?((0,a.uX)(),(0,a.CE)("tr",A,[e[16]||(e[16]=(0,a.Lk)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1)),(0,a.Lk)("td",K,(0,l.v_)(t.$filters.currency(H.cart.final_total)),1)])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",D,[(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=t=>H.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[o.Jo,H.coupon_code]]),(0,a.Lk)("div",J,[(0,a.Lk)("button",{class:"btn btn-outline-secondary",type:"button",onClick:e[5]||(e[5]=(...t)=>N.addCouponCode&&N.addCouponCode(...t))}," 套用優惠碼 ")])])])])]),(0,a.Lk)("div",S,[(0,a.bF)(tt,{class:"col-md-6",onSubmit:N.createOrder},{default:(0,a.k6)(({errors:t})=>[(0,a.Lk)("div",W,[e[18]||(e[18]=(0,a.Lk)("label",{for:"email",class:"form-label"},"Email",-1)),(0,a.bF)(Y,{id:"email",name:"email",type:"email",class:(0,l.C4)(["form-control",{"is-invalid":t["email"]}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:H.form.user.email,"onUpdate:modelValue":e[6]||(e[6]=t=>H.form.user.email=t)},null,8,["class","modelValue"]),(0,a.bF)(Z,{name:"email",class:"invalid-feedback"})]),(0,a.Lk)("div",M,[e[19]||(e[19]=(0,a.Lk)("label",{for:"name",class:"form-label"},"收件人姓名",-1)),(0,a.bF)(Y,{id:"name",name:"姓名",type:"text",class:(0,l.C4)(["form-control",{"is-invalid":t["姓名"]}]),placeholder:"請輸入姓名",rules:"required",modelValue:H.form.user.name,"onUpdate:modelValue":e[7]||(e[7]=t=>H.form.user.name=t)},null,8,["class","modelValue"]),(0,a.bF)(Z,{name:"姓名",class:"invalid-feedback"})]),(0,a.Lk)("div",O,[e[20]||(e[20]=(0,a.Lk)("label",{for:"tel",class:"form-label"},"收件人電話",-1)),(0,a.bF)(Y,{id:"tel",name:"電話",type:"tel",class:(0,l.C4)(["form-control",{"is-invalid":t["電話"]}]),placeholder:"請輸入電話",rules:"required",modelValue:H.form.user.tel,"onUpdate:modelValue":e[8]||(e[8]=t=>H.form.user.tel=t)},null,8,["class","modelValue"]),(0,a.bF)(Z,{name:"電話",class:"invalid-feedback"})]),(0,a.Lk)("div",z,[e[21]||(e[21]=(0,a.Lk)("label",{for:"address",class:"form-label"},"收件人地址",-1)),(0,a.bF)(Y,{id:"address",name:"地址",type:"text",class:(0,l.C4)(["form-control",{"is-invalid":t["地址"]}]),placeholder:"請輸入地址",rules:"required",modelValue:H.form.user.address,"onUpdate:modelValue":e[9]||(e[9]=t=>H.form.user.address=t)},null,8,["class","modelValue"]),(0,a.bF)(Z,{name:"地址",class:"invalid-feedback"})]),(0,a.Lk)("div",B,[e[22]||(e[22]=(0,a.Lk)("label",{for:"message",class:"form-label"},"留言",-1)),(0,a.bo)((0,a.Lk)("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":e[10]||(e[10]=t=>H.form.message=t)},null,512),[[o.Jo,H.form.message]])]),e[23]||(e[23]=(0,a.Lk)("div",{class:"text-end"},[(0,a.Lk)("button",{class:"btn btn-danger"},"送出訂單")],-1))]),_:1,__:[23]},8,["onSubmit"])])])],64)}s(4114),s(8111),s(2489);var H=s(7442),N={data(){return{products:[],product:{},selectedCategory:"",status:{loadingItem:""},cart:{},coupon_code:"",currentPage:1,perPage:9,form:{user:{name:"",email:"",tel:"",address:""},message:""}}},computed:{filteredProducts(){return this.selectedCategory?this.products.filter(t=>t.category===this.selectedCategory):this.products},paginatedProducts(){const t=(this.currentPage-1)*this.perPage,e=t+this.perPage;return this.filteredProducts.slice(t,e)},totalPages(){return Math.ceil(this.filteredProducts.length/this.perPage)}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/v2/api/xenosword-api/products/all";this.isLoading=!0,this.$http.get(t).then(t=>{this.products=t.data.products,this.isLoading=!1})},getProduct(t){this.$router.push(`/user/product/${t}`)},addCart(t){const e="https://vue3-course-api.hexschool.io/v2/api/xenosword-api/cart";this.status.loadingItem=t;const s={product_id:t,qty:1};this.$http.post(e,{data:s}).then(t=>{this.status.loadingItem="",this.showToast("success","已加入購物車"),this.getCart(),console.log(t)}).catch(t=>{this.showToast("error","商品已無庫存"),console.log(t)})},updateCart(t){const e=`https://vue3-course-api.hexschool.io/v2/api/xenosword-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const s={product_id:t.product_id,qty:t.qty};this.$http.put(e,{data:s}).then(t=>{console.log(t),this.status.loadingItem="",this.isLoading=!1,this.getCart()})},delCartItem(t){const e=`https://vue3-course-api.hexschool.io/v2/api/xenosword-api/cart/${t}`;this.isLoading=!0,this.status.loadingItem=t,this.$http.delete(e,t).then(t=>{console.log(t),this.showToast("success","商品已刪除"),this.status.loadingItem="",this.getCart(),this.isLoading=!1})},delAllCart(){const t="https://vue3-course-api.hexschool.io/v2/api/xenosword-api/carts";this.isLoading=!0,this.$http.delete(t).then(t=>{console.log(t),this.showToast("success","已清空購物車"),this.getCart(),this.isLoading=!1})},addCouponCode(){const t="https://vue3-course-api.hexschool.io/v2/api/xenosword-api/coupon",e={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:e}).then(t=>{console.log(t),this.showToast("success","已成功加入優惠券"),this.getCart(),this.isLoading=!1}).catch(t=>{console.log(t),this.showToast("error","該優惠券不存在")})},getCart(){const t="https://vue3-course-api.hexschool.io/v2/api/xenosword-api/cart";this.isLoading=!0,this.$http.get(t).then(t=>{console.log(t),this.cart=t.data.data,this.isLoading=!1})},createOrder(){const t="https://vue3-course-api.hexschool.io/v2/api/xenosword-api/order",e=this.form;this.isLoading=!0,this.$http.post(t,{data:e}).then(t=>{console.log(t),this.showToast("success","已送出訂單");const e=t.data.orderId;this.$router.push(`/user/checkout/${e}`)})}},created(){this.getProducts(),this.getCart()},mixins:[H.A]},R=s(1241);const Y=(0,R.A)(N,[["render",G]]);var Z=Y}}]);
//# sourceMappingURL=422.c1e0d1b4.js.map