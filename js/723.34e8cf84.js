"use strict";(self["webpackChunkfinal_project"]=self["webpackChunkfinal_project"]||[]).push([[723],{1335:function(e,t,o){o.d(t,{A:function(){return m}});var a=o(6768),n=o(4232),s=o(5130);const l={"aria-label":"Page navigation example"},i={class:"pagination justify-content-center"},d=["onClick"];function c(e,t,o,c,p,u){return(0,a.uX)(),(0,a.CE)("nav",l,[(0,a.Lk)("ul",i,[t[0]||(t[0]=(0,a.Lk)("li",{class:"page-item"},[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Previous"},[(0,a.Lk)("span",{"aria-hidden":"true"},"«")])],-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.pages.total_pages,e=>((0,a.uX)(),(0,a.CE)("li",{class:(0,n.C4)(["page-item",{active:e===o.pages.current_page}]),key:e},[(0,a.Lk)("a",{class:"page-link",href:"#",onClick:(0,s.D$)(t=>u.updatePage(e),["prevent"])},(0,n.v_)(e),9,d)],2))),128)),t[1]||(t[1]=(0,a.Lk)("li",{class:"page-item"},[(0,a.Lk)("a",{class:"page-link",href:"#","aria-label":"Next"},[(0,a.Lk)("span",{"aria-hidden":"true"},"»")])],-1))])])}var p={props:["pages"],methods:{updatePage(e){this.$emit("emit-pages",e)}}},u=o(1241);const r=(0,u.A)(p,[["render",c]]);var m=r},3723:function(e,t,o){o.r(t),o.d(t,{default:function(){return W}});var a=o(6768),n=o(4232);const s={class:"d-flex justify-content-between align-items-center my-4"},l={class:"table-responsive"},i={class:"table table-hover align-middle text-nowrap"},d={class:"text-center"},c={class:"text-center"},p={class:"text-center"},u={class:"text-center"},r={class:"btn-group"},m=["onClick"],h=["onClick"];function b(e,t,o,b,k,L){const g=(0,a.g2)("Loading"),C=(0,a.g2)("CouponModal"),v=(0,a.g2)("DelModal"),f=(0,a.g2)("Pagination");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(g,{active:k.isLoading},null,8,["active"]),(0,a.Lk)("div",s,[t[2]||(t[2]=(0,a.Lk)("h2",{class:"h4 fw-bold"},"優惠券管理",-1)),(0,a.Lk)("button",{class:"btn btn-primary d-flex align-items-center gap-1",onClick:t[0]||(t[0]=e=>L.openCouponModal(!0))},t[1]||(t[1]=[(0,a.Lk)("i",{class:"bi bi-plus-circle"},null,-1),(0,a.eW)(" 建立新的優惠券 ")]))]),(0,a.Lk)("div",l,[(0,a.Lk)("table",i,[t[5]||(t[5]=(0,a.Lk)("thead",{class:"table-light"},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",null,"名稱"),(0,a.Lk)("th",{class:"text-center"},"折扣百分比"),(0,a.Lk)("th",{class:"text-center"},"到期日"),(0,a.Lk)("th",{class:"text-center"},"狀態"),(0,a.Lk)("th",{class:"text-center"},"操作")])],-1)),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(k.coupons,(e,o)=>((0,a.uX)(),(0,a.CE)("tr",{key:o},[(0,a.Lk)("td",null,(0,n.v_)(e.title),1),(0,a.Lk)("td",d,(0,n.v_)(e.percent)+"%",1),(0,a.Lk)("td",c,(0,n.v_)(L.formatDate(e.due_date)),1),(0,a.Lk)("td",p,[(0,a.Lk)("span",{class:(0,n.C4)(["badge",1===e.is_enabled?"bg-success":"bg-secondary"])},(0,n.v_)(1===e.is_enabled?"啟用":"未啟用"),3)]),(0,a.Lk)("td",u,[(0,a.Lk)("div",r,[(0,a.Lk)("button",{class:"btn btn-outline-primary btn-sm",onClick:t=>L.openCouponModal(!1,e)},t[3]||(t[3]=[(0,a.Lk)("i",{class:"bi bi-pencil-square"},null,-1),(0,a.eW)(" 編輯 ")]),8,m),(0,a.Lk)("button",{class:"btn btn-outline-danger btn-sm",onClick:t=>L.openDelCouponModal(e)},t[4]||(t[4]=[(0,a.Lk)("i",{class:"bi bi-trash"},null,-1),(0,a.eW)(" 刪除 ")]),8,h)])])]))),128))])])]),(0,a.bF)(C,{coupon:k.tempCoupon,ref:"couponModal",isNew:k.isNew,onUpdateCoupon:L.updateCoupon},null,8,["coupon","isNew","onUpdateCoupon"]),(0,a.bF)(v,{item:k.tempCoupon,ref:"delModal",onDelItem:L.delCoupon},null,8,["item","onDelItem"]),(0,a.bF)(f,{pages:k.pagination,onEmitPages:L.getCoupons},null,8,["pages","onEmitPages"])])}var k=o(5130);const L={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},g={class:"modal-dialog",role:"document"},C={class:"modal-content"},v={class:"modal-header"},f={class:"modal-title",id:"exampleModalLabel"},w={class:"modal-body"},x={class:"mb-3"},_={class:"mb-3"},y={class:"mb-3"},M={class:"mb-3"},A={class:"mb-3"},D={class:"form-check"},$={class:"modal-footer"};function N(e,t,o,s,l,i){return(0,a.uX)(),(0,a.CE)("div",L,[(0,a.Lk)("div",g,[(0,a.Lk)("div",C,[(0,a.Lk)("div",v,[(0,a.Lk)("h5",f,[(0,a.Lk)("span",null,(0,n.v_)(o.isNew?"新增優惠券":"編輯優惠券"),1)]),t[6]||(t[6]=(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,a.Lk)("div",w,[(0,a.Lk)("div",x,[t[7]||(t[7]=(0,a.Lk)("label",{for:"title"},"標題",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":t[0]||(t[0]=e=>l.tempCoupon.title=e),placeholder:"請輸入標題"},null,512),[[k.Jo,l.tempCoupon.title]])]),(0,a.Lk)("div",_,[t[8]||(t[8]=(0,a.Lk)("label",{for:"coupon_code"},"優惠碼",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":t[1]||(t[1]=e=>l.tempCoupon.code=e),placeholder:"請輸入優惠碼"},null,512),[[k.Jo,l.tempCoupon.code]])]),(0,a.Lk)("div",y,[t[9]||(t[9]=(0,a.Lk)("label",{for:"due_date"},"到期日",-1)),(0,a.bo)((0,a.Lk)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=e=>l.due_date=e)},null,512),[[k.Jo,l.due_date]])]),(0,a.Lk)("div",M,[t[10]||(t[10]=(0,a.Lk)("label",{for:"price"},"折扣百分比",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":t[3]||(t[3]=e=>l.tempCoupon.percent=e),placeholder:"請輸入折扣百分比"},null,512),[[k.Jo,l.tempCoupon.percent,void 0,{number:!0}]])]),(0,a.Lk)("div",A,[(0,a.Lk)("div",D,[(0,a.bo)((0,a.Lk)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":t[4]||(t[4]=e=>l.tempCoupon.is_enabled=e),id:"is_enabled"},null,512),[[k.lH,l.tempCoupon.is_enabled]]),t[11]||(t[11]=(0,a.Lk)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1))])])]),(0,a.Lk)("div",$,[t[12]||(t[12]=(0,a.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=t=>e.$emit("update-coupon",l.tempCoupon))},"Save changes ")])])])],512)}var P=o(3286),E={props:{coupon:{},isNew:Boolean},data(){return{tempCoupon:{},due_date:""}},watch:{coupon(){this.tempCoupon=this.coupon;const e=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");[this.due_date]=e},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[P.A]},I=o(1241);const T=(0,I.A)(E,[["render",N]]);var X=T,U=o(5340),F=o(1335),S={components:{CouponModal:X,DelModal:U.A,Pagination:F.A},data(){return{coupons:{},pagination:{},tempCoupon:{title:"",is_enabled:0,percent:100,code:""},isLoading:!1,isNew:!1}},methods:{getCoupons(e=1){const t="https://vue3-course-api.hexschool.io/v2/api/xenosword-api/admin/coupons";this.isLoading=!0,this.$http.get(t).then(e=>{this.coupons=e.data.coupons,this.pagination=e.data.pagination,this.isLoading=!1}).catch(e=>{console.error("API 錯誤：",e),this.showToast("error","資料載入失敗")})},openCouponModal(e,t){this.isNew=e,this.isNew?this.tempCoupon={due_date:(new Date).getTime()/1e3}:this.tempCoupon={...t},this.$refs.couponModal.showModal()},openDelCouponModal(e){this.tempCoupon={...e};const t=this.$refs.delModal;t.showModal()},updateCoupon(e){this.tempCoupon=e;let t="https://vue3-course-api.hexschool.io/v2/api/xenosword-api/admin/coupon",o="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/xenosword-api/admin/coupon/${this.tempCoupon.id}`,o="put"),this.isLoading=!0,this.$http[o](t,{data:this.tempCoupon}).then(e=>{this.isLoading=!1,e.data.success?(this.$refs.couponModal.hideModal(),this.getCoupons(),this.showToast("success",this.isNew?"新增優惠券成功":"更新優惠券成功")):this.showToast("error",this.isNew?"新增優惠券失敗":"更新優惠券失敗")}).catch(e=>{console.error("API 錯誤：",e),this.showToast("error","資料載入失敗")})},delCoupon(){const e=`https://vue3-course-api.hexschool.io/v2/api/xenosword-api/admin/coupon/${this.tempCoupon.id}`;this.isLoading=!0,this.$http.delete(e).then(()=>{const e=this.$refs.delModal;e.hideModal(),this.getCoupons()}).catch(e=>{console.error("API 錯誤：",e),this.showToast("error","資料刪除失敗")})},formatDate(e){const t=new Date(1e3*e);return t.toISOString().split("T")[0]}},created(){this.getCoupons()}};const V=(0,I.A)(S,[["render",b]]);var W=V},5340:function(e,t,o){o.d(t,{A:function(){return g}});var a=o(6768),n=o(4232);const s={class:"modal fade",id:"delModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},l={class:"modal-dialog",role:"document"},i={class:"modal-content border-0"},d={class:"modal-header bg-danger text-white"},c={class:"modal-title"},p={class:"modal-body"},u={class:"text-danger"},r={class:"modal-footer"};function m(e,t,o,m,h,b){return(0,a.uX)(),(0,a.CE)("div",s,[(0,a.Lk)("div",l,[(0,a.Lk)("div",i,[(0,a.Lk)("div",d,[(0,a.Lk)("h5",c,[(0,a.Lk)("span",null,"刪除 "+(0,n.v_)(o.item.title),1)]),t[1]||(t[1]=(0,a.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1))]),(0,a.Lk)("div",p,[t[2]||(t[2]=(0,a.eW)(" 是否刪除 ")),(0,a.Lk)("strong",u,(0,n.v_)(o.item.title),1),t[3]||(t[3]=(0,a.eW)(" (刪除後將無法恢復)。 "))]),(0,a.Lk)("div",r,[t[4]||(t[4]=(0,a.Lk)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1)),(0,a.Lk)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.$emit("del-item"))},"確認刪除 ")])])])],512)}var h=o(3286),b={props:{item:{}},data(){return{modal:""}},mixins:[h.A]},k=o(1241);const L=(0,k.A)(b,[["render",m]]);var g=L}}]);
//# sourceMappingURL=723.34e8cf84.js.map